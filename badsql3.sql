select /*SOQL*/ "LastModifiedDate","ColAlias1","LastModifiedById","GEO_PromoRecurrenteAplicada__c","ColAlias2","GEO_VerPDFReguladaGasSF__c","GEO_ReportadoHomeserve__c","ColAlias3","ColAlias4","GEO_CounterRent__c","CreatedById","ColAlias5","GEO_TollPower1__c","ColAlias6","ColAlias7","GEO_Invoiced_Consumption__c","ColAlias8","ColAlias9","ColAlias10","ColAlias11","GEO_TipoTelegestion__c","ColAlias12","PODO_Secondary_Payer__c","GEO_Correction_Invoice__c","ColAlias13","ColAlias14","ColAlias15","RecordTypeId","GEO_Adjusted_Consumption__c","GEO_VATAmountLuzGas__c","ColAlias16","GEO_Tariff__c","GEO_VerPDFReguladaLuzSF__c","GEO_Validacion_subtotal__c","SystemModstamp","GEO_Error_description__c","t.ID","GEO_Distributor_Phone__c","GEO_Distributor_Name__c","ColAlias17","ColAlias18","GEO_CorregidaOperaciones__c","Name","GEO_FixedFeeNext__c","ColAlias19","GEO_Toll_Energy_P1__c","GEO_PromocionGas__c","ColAlias20","GEO_Validacion_IVA__c","ColAlias21","CreatedDate","GEO_Address__c","GEO_PromoUnicaAplicada__c","GEO_Status__c","GEO_Invoice_URL__c","ColAlias22","GEO_TotalText__c","GEO_Correo_de_ajuste__c","GEO_Validacion_Cuota_del__c","ColAlias23","GEO_Invoice_Date__c","GEO_Invoice_Number__c","GEO_Email_Status__c","ColAlias24","ColAlias25","GEO_GasVATAmount__c","GEO_Fixed_Fee__c","GEO_Toll_Energy_P2__c","GEO_GasP1UnitPrice__c","GEO_Total__c","GEO_Previous_Reading_2__c","ColAlias26","GEO_Fecha_Factura_Monitorio__c","Invoice_Date_Month__c","ColAlias27","ColAlias28","ColAlias29","GEO_GCLEnviado__c","GEO_FacturaId__c","ColAlias30","GEO_First_Invoice__c","GEO_DesvioMensual__c","ColAlias31","PODO_Secondary_Payer_Quota__c","Id","GEO_IsDual__c","GEO_InvoiceDeCierre__c","ColAlias32","ColAlias33","ColAlias34","ColAlias35","ColAlias36","ColAlias37","ColAlias38","ColAlias39","GEO_PromoAplicada__c","ColAlias40","GEO_GasP1ConsumptionKwh__c","GEO_Smappe_discount__c","ColAlias41","GEO_PromoPodoAmigoAplicada__c","ColAlias42","GEO_TotalLuzGas__c","GEO_ContractNumber__c","GEO_GasFeeBase__c","GEO_estimatedEndOfContract__c","GEO_Invoice_Number_Inc__c","GEO_VerPdfInformes__c","ColAlias43","PODO_Invoice_Type__c","GEO_CUPS__c","GEO_GasTotal__c","GEO_Previous_Reading_1__c","GEO_CounterType__c","GEO_Current_Reading_1__c","GEO_VerPDFSF__c","GEO_TotalBeforeVAT__c","GEO_FixedFeeCurrent__c","GEO_NumeroDeAbono__c","GEO_Factura_Monitorio__c","ColAlias44","GEO_TotalGasFee__c","GEO_Current_Reading_2__c","ColAlias45","GEO_accumulated__c","ColAlias46","ColAlias47","GEO_SubtotalFeed__c","GEO_cme__c","GEO_Subtotal__c","GEO_MigradaAPv2__c","GEO_VATAmount__c","Ver_PDFSFMantenimiento__c","GEO_Sum_Consumptions__c","GEO_FacturaProforma__c","ColAlias48","GEO_Validacion_consumo__c","GEO_TollPower1__c__f","GEO_TotalLuzGas__c__f","UsrAlias49","CreatedDate__f","PODO_Invoice_Type__c__l","UsrAlias50","UsrAlias51","GEO_PromocionGas__c__f","UsrAlias52","GEO_Smappe_discount__c__f","GEO_Toll_Energy_P1__c__f","UsrAlias53","UsrAlias54","UsrAlias55","GEO_Invoice_Date__c__f","UsrAlias56","GEO_Subtotal__c__f","UsrAlias57","LastModifiedDate__f","UsrAlias58","GEO_VATAmountLuzGas__c__f","GEO_TotalBeforeVAT__c__f","GEO_FixedFeeNext__c__f","GEO_VATAmount__c__f","GEO_GasVATAmount__c__f","GEO_Status__c__l","GEO_SubtotalFeed__c__f","GEO_Email_Status__c__l","UsrAlias59","GEO_CounterRent__c__f","SystemModstamp__f","GEO_Total__c__f","UsrAlias60","UsrAlias61","GEO_Toll_Energy_P2__c__f","UsrAlias62","UsrAlias63","UsrAlias64","UsrAlias65","GEO_GasTotal__c__f","UsrAlias66","UsrAlias67","UsrAlias68","UsrAlias69","UsrAlias70","GEO_DesvioMensual__c__f","UsrAlias71","UsrAlias72","GEO_GasFeeBase__c__f","UsrAlias73","UsrAlias74","GEO_Fixed_Fee__c__f","UsrAlias75","UsrAlias76","UsrAlias77","UsrAlias78","GEO_TotalGasFee__c__f","UsrAlias79","GEO_FixedFeeCurrent__c__f","UsrAlias80","UsrAlias81","UsrAlias82"from (select /*+ ordered index(t pkcustom_entity_data) use_nl(t_spn0) use_nl(t_spn1) use_nl(t_spn1_0) use_nl(t_spn1_1) use_nl(t_spn2) use_nl(t_spn3) */t.deleted "IsDeleted_gen_1",t.custom_entity_data_id "Id",t.last_update "LastModifiedDate",t.val191 "ColAlias1",t.last_update_by "LastModifiedById",t.val240 "GEO_PromoRecurrenteAplicada__c",TO_NUMBER(t.val189) "ColAlias2",SUBSTR(CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN (https://mipodo--c.um4.visual.force.com/apex/GEO_PDF_FacturaReguladaGas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE END, 0, 1300) "GEO_VerPDFReguladaGasSF__c",t.val297 "GEO_ReportadoHomeserve__c",ROUND(NVL(TO_NUMBER(t.val302), 0), 2) "ColAlias3",TO_NUMBER(t.val92) "ColAlias4",TO_NUMBER(t.val108) "GEO_CounterRent__c",t.created_by "CreatedById",t.val255 "ColAlias5",TO_NUMBER(t.val170) "GEO_TollPower1__c",TO_NUMBER(t.val86) "ColAlias6",TO_NUMBER(t.val106) "ColAlias7",t.val0 "GEO_Invoiced_Consumption__c",t.val105 "ColAlias8",TO_NUMBER(t.val15) "ColAlias9",ROUND((NVL(TO_NUMBER(t.val97), 0)+NVL(TO_NUMBER(t.val157), 0)), 2) "ColAlias10",TO_NUMBER(t.val64) "ColAlias11",NULL "GEO_TipoTelegestion__c",t.val181 "ColAlias12",t.val180 "PODO_Secondary_Payer__c",t.val188 "GEO_Correction_Invoice__c",TO_NUMBER(t.val175) "ColAlias13",TO_NUMBER(t.val72) "ColAlias14",TO_NUMBER(t.val73) "ColAlias15",t.record_type_id "RecordTypeId",SUBSTR(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), 0, 1300) "GEO_Adjusted_Consumption__c",ROUND((NVL(TO_NUMBER(t.val264), 0)+NVL(TO_NUMBER(t.val117), 0)), 2) "GEO_VATAmountLuzGas__c",TO_NUMBER(t.val84) "ColAlias16",SUBSTR(t_spn0.val41, 0, 1300) "GEO_Tariff__c",SUBSTR((https://mipodo--c.um4.visual.force.com/apex/GEO_PDF_FacturaRegulada?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END), 0, 1300) "GEO_VerPDFReguladaLuzSF__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (NVL(TO_NUMBER(t.val116), 0)=((NVL(TO_NUMBER(t.val88), 0)+NVL(TO_NUMBER(t.val95), 0))+NVL(TO_NUMBER(t.val96), 0))) THEN 1 ELSE 0 END ELSE CASE WHEN (NVL(TO_NUMBER(t.val116), 0)=(NVL(TO_NUMBER(t.val114), 0)+NVL(TO_NUMBER(t.val115), 0))) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_subtotal__c",t.system_modstamp "SystemModstamp",t.val217 "GEO_Error_description__c",t.custom_entity_data_id "t.ID",NULL "GEO_Distributor_Phone__c",NULL "GEO_Distributor_Name__c",TO_NUMBER(t.val66) "ColAlias17",TO_NUMBER(t.val114) "ColAlias18",t.val286 "GEO_CorregidaOperaciones__c",t.name "Name",TO_NUMBER(t.val110) "GEO_FixedFeeNext__c",TO_NUMBER(t.val185) "ColAlias19",TO_NUMBER(t.val151) "GEO_Toll_Energy_P1__c",TO_NUMBER(t.val266) "GEO_PromocionGas__c",TO_NUMBER(t.val249) "ColAlias20",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))), 2)=NVL(TO_NUMBER(t.val117), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))), 2)=NVL(TO_NUMBER(t.val117), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_IVA__c",TO_NUMBER(t.val70) "ColAlias21",t.created_date "CreatedDate",NULL "GEO_Address__c",t.val241 "GEO_PromoUnicaAplicada__c",t.val77 "GEO_Status__c",SUBSTR(_HL_ENCODED_ || NVL((/servlet/servlet.FileDownload?file=||t.val182), ) || _HL_ || NVL(t.val183, ) || _HL_ || NVL(_blank, ) || _HL_, 0, 1300) "GEO_Invoice_URL__c",CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END "ColAlias22",SUBSTR(CASE WHEN (ROUND(TO_NUMBER(t.val189), 2) IS NULL) THEN REPLACE((TO_CHAR(ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2))), ., ,) ELSE REPLACE((TO_CHAR(ROUND(TO_NUMBER(t.val189), 2))), ., ,) END, 0, 1300) "GEO_TotalText__c",CASE WHEN NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR ((ABS(TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .)))>5) AND (NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$))) THEN NULL ELSE CASE WHEN ((ABS(TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .)))>5) AND (TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .))>CASE WHEN (NVL(TO_NUMBER(t.val189), 0)=0) THEN (NVL(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 0)/10) ELSE (NVL(TO_NUMBER(t.val189), 0)/10) END) AND (NVL(t_spn2.name, Flexible||x)=Flexible)) THEN 1 ELSE 0 END END "GEO_Correo_de_ajuste__c",CASE WHEN (CASE WHEN ((CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) AND (EXTRACT (DAY FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END)=15) AND (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN ((NVL(t_spn0.val105, 0) = 1) OR ((EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))>15) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=2)) OR ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) AND ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=0)) THEN CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * NVL(TO_NUMBER(t.val210), 0)), 2)) AND (NVL(TO_NUMBER(t.val110), 0)=0)) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN (CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * (NVL(TO_NUMBER(t.val210), 0)-1)), 2)) AND (NVL(TO_NUMBER(t.val110), 0)=NVL(TO_NUMBER(t_spn0.val18), 0))) THEN 1 ELSE 0 END ELSE CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=0) AND (NVL(TO_NUMBER(t.val110), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * NVL(TO_NUMBER(t.val210), 0)), 2))) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_Cuota_del__c",TO_NUMBER(t.val63) "ColAlias23",CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END "GEO_Invoice_Date__c",SUBSTR(LPAD((TO_CHAR(NVL(TO_NUMBER(t.val44), 0))), GREATEST(7, 0), 0), 0, 1300) "GEO_Invoice_Number__c",t.val190 "GEO_Email_Status__c",TO_NUMBER(t.val262) "ColAlias24",TO_NUMBER(t.val20) "ColAlias25",TO_NUMBER(t.val264) "GEO_GasVATAmount__c",TO_NUMBER(t.val40) "GEO_Fixed_Fee__c",TO_NUMBER(t.val152) "GEO_Toll_Energy_P2__c",TO_NUMBER(t.val261) "GEO_GasP1UnitPrice__c",TO_NUMBER(t.val97) "GEO_Total__c",TO_NUMBER(t.val54) "GEO_Previous_Reading_2__c",t.val312 "ColAlias26",TO_DATE(t.val307) "GEO_Fecha_Factura_Monitorio__c",ROUND(EXTRACT (MONTH FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END), 0) "Invoice_Date_Month__c",TO_NUMBER(t.val107) "ColAlias27",TO_NUMBER(t.val9) "ColAlias28",ROUND(NVL(TO_NUMBER(t.val175), 0), 2) "ColAlias29",t.val292 "GEO_GCLEnviado__c",t.val182 "GEO_FacturaId__c",CASE WHEN (NVL(TO_NUMBER(t.val108), 0)=ROUND((NVL(TO_NUMBER(t.val107), 0) * NVL(TO_NUMBER(t.val210), 0)), 2)) THEN 1 ELSE 0 END "ColAlias30",t.val37 "GEO_First_Invoice__c",TO_NUMBER(t.val253) "GEO_DesvioMensual__c",NULL "ColAlias31",ROUND(NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0) * 100.0, 0) "PODO_Secondary_Payer_Quota__c",CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END "GEO_IsDual__c",CASE WHEN (NVL(CASE WHEN null THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END "GEO_InvoiceDeCierre__c",TO_NUMBER(t.val113) "ColAlias32",TO_NUMBER(t.val121) "ColAlias33",TO_NUMBER(t.val71) "ColAlias34",TO_NUMBER(t.val260) "ColAlias35",TO_NUMBER(t.val47) "ColAlias36",TO_NUMBER(t.val176) "ColAlias37",ROUND((NVL(TO_NUMBER(t.val199), 0)+NVL(NVL(TO_NUMBER(t.val262), 0), 0)), 2) "ColAlias38",TO_NUMBER(t.val313) "ColAlias39",CASE WHEN ((NVL(TO_NUMBER(t.val197), 0)>0) OR (NVL(TO_NUMBER(t.val186), 0)>0) OR (NVL(TO_NUMBER(t.val185), 0)>0) OR (NVL(TO_NUMBER(t.val198), 0)>0)) THEN 1 ELSE 0 END "GEO_PromoAplicada__c",TO_NUMBER(t.val197) "ColAlias40",TO_NUMBER(t.val259) "GEO_GasP1ConsumptionKwh__c",TO_NUMBER(t.val186) "GEO_Smappe_discount__c",NULL "ColAlias41",t.val239 "GEO_PromoPodoAmigoAplicada__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (ROUND((0.0511269632 * NVL(TO_NUMBER(t.val116), 0)), 2)=NVL(TO_NUMBER(t.val113), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ROUND((0.0511269632 * (NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val108), 0))), 2)=NVL(TO_NUMBER(t.val113), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "ColAlias42",ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2) "GEO_TotalLuzGas__c",NULL "GEO_ContractNumber__c",TO_NUMBER(t.val257) "GEO_GasFeeBase__c",TO_NUMBER(t.val195) "GEO_estimatedEndOfContract__c",TO_NUMBER(t.val44) "GEO_Invoice_Number_Inc__c",SUBSTR(CASE WHEN (NVL(t.val182, NULL||x)=NVL(NULL, t.val182||x)) THEN CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijogas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexigas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolargas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE NULL END ELSE CASE WHEN (t_spn0.val78 IS NOT NULL AND t_spn0.val78 = 4) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaabono?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijo?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexi?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolar?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexitres?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) END END END ELSE ((https://micuenta.mipodo.com/||PODO_InvoiceViewer?AttachmentURL=/servlet/servlet.FileDownload?file=)||t.val182) END, 0, 1300) "GEO_VerPdfInformes__c",TO_NUMBER(t.val258) "ColAlias43",t.val177 "PODO_Invoice_Type__c",SUBSTR(t_spn0.val4, 0, 1300) "GEO_CUPS__c",TO_NUMBER(t.val263) "GEO_GasTotal__c",TO_NUMBER(t.val53) "GEO_Previous_Reading_1__c",SUBSTR(CASE WHEN (NVL(null, 01||x)=01) THEN Telegestión operativa con Curva de Carga Horaria WHEN (NVL(null, 02||x)=02) THEN Telegestión Operativa sin curva de carga Horaria ELSE Sin Telegestión END, 0, 1300) "GEO_CounterType__c",TO_NUMBER(t.val24) "GEO_Current_Reading_1__c",SUBSTR(CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijogas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexigas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolargas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE NULL END ELSE CASE WHEN (t_spn0.val78 IS NOT NULL AND t_spn0.val78 = 4) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaabono?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijo?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexi?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolar?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexitres?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) END END END, 0, 1300) "GEO_VerPDFSF__c",ROUND(CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0)) END,TO_NUMBER(NULL)) ELSE NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0)) END,TO_NUMBER(NULL)) END, 2) "GEO_TotalBeforeVAT__c",TO_NUMBER(t.val109) "GEO_FixedFeeCurrent__c",SUBSTR(CASE WHEN (NVL(TO_NUMBER(t.val287), 0)<>0) THEN (A||LPAD((TO_CHAR(NVL(TO_NUMBER(t.val287), 0))), GREATEST(7, 0), 0)) ELSE t.val188 END, 0, 1300) "GEO_NumeroDeAbono__c",t.val306 "GEO_Factura_Monitorio__c",TO_NUMBER(t.val198) "ColAlias44",TO_NUMBER(t.val269) "GEO_TotalGasFee__c",TO_NUMBER(t.val25) "GEO_Current_Reading_2__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (((((((((((ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))), 2)+NVL(TO_NUMBER(t.val116), 0))-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))-NVL(TO_NUMBER(t.val198), 0))-NVL(TO_NUMBER(t.val197), 0))=NVL(TO_NUMBER(t.val97), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (((((((((((ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))), 2)+NVL(TO_NUMBER(t.val116), 0))-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))-NVL(TO_NUMBER(t.val198), 0))-NVL(TO_NUMBER(t.val197), 0))=NVL(TO_NUMBER(t.val97), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "ColAlias45",TO_NUMBER(t.val194) "GEO_accumulated__c",TO_NUMBER(t.val8) "ColAlias46",t.val309 "ColAlias47",TO_NUMBER(t.val115) "GEO_SubtotalFeed__c",TO_NUMBER(t.val205) "GEO_cme__c",TO_NUMBER(t.val116) "GEO_Subtotal__c",t.val318 "GEO_MigradaAPv2__c",TO_NUMBER(t.val117) "GEO_VATAmount__c",SUBSTR(CASE WHEN (NVL(TO_NUMBER(t.val281), 0)<>0) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturahomeserve?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE END, 0, 1300) "Ver_PDFSFMantenimiento__c",ROUND(NVL(TO_NUMBER(t_spn0.val8), 0), 2) "GEO_Sum_Consumptions__c",t.val308 "GEO_FacturaProforma__c",TO_NUMBER(t.val302) "ColAlias48",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (((ROUND((NVL(TO_NUMBER(t_spn0.val5), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)), 2)+ROUND((NVL(TO_NUMBER(t_spn0.val6), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)), 2))+ROUND((NVL(TO_NUMBER(t_spn0.val7), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)), 2))=NVL(TO_NUMBER(t.val88), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN ((NVL(t_spn2.name, Flexible||x)=Flexible) AND (CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) AND (EXTRACT (DAY FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END)=15) AND (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN ((NVL(t_spn0.val105, 0) = 1) OR ((EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))>15) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=2)) OR ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) AND ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=0)) THEN CASE WHEN (NVL(TO_NUMBER(t.val114), 0)=0) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN (NVL(t_spn2.name, Flexible||x)=Flexible) THEN CASE WHEN ((ROUND((NVL(TO_NUMBER(t_spn0.val5), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)), 2)+ROUND((NVL(TO_NUMBER(t_spn0.val6), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)), 2))=NVL(TO_NUMBER(t.val114), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (0=NVL(TO_NUMBER(t.val114), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_consumo__c",TO_NUMBER(t.val170) "GEO_TollPower1__c__f",ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2) "GEO_TotalLuzGas__c__f",TO_NUMBER(t.val249) "UsrAlias49",t.created_date "CreatedDate__f",t.val177 "PODO_Invoice_Type__c__l",TO_NUMBER(t.val64) "UsrAlias50",TO_NUMBER(t.val107) "UsrAlias51",TO_NUMBER(t.val266) "GEO_PromocionGas__c__f",TO_NUMBER(t.val92) "UsrAlias52",TO_NUMBER(t.val186) "GEO_Smappe_discount__c__f",TO_NUMBER(t.val151) "GEO_Toll_Energy_P1__c__f",ROUND((NVL(TO_NUMBER(t.val97), 0)+NVL(TO_NUMBER(t.val157), 0)), 2) "UsrAlias53",TO_NUMBER(t.val302) "UsrAlias54",TO_NUMBER(t.val70) "UsrAlias55",CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END "GEO_Invoice_Date__c__f",TO_NUMBER(t.val72) "UsrAlias56",TO_NUMBER(t.val116) "GEO_Subtotal__c__f",TO_NUMBER(t.val189) "UsrAlias57",t.last_update "LastModifiedDate__f",TO_NUMBER(t.val47) "UsrAlias58",ROUND((NVL(TO_NUMBER(t.val264), 0)+NVL(TO_NUMBER(t.val117), 0)), 2) "GEO_VATAmountLuzGas__c__f",ROUND(CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0)) END,TO_NUMBER(NULL)) ELSE NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0)) END,TO_NUMBER(NULL)) END, 2) "GEO_TotalBeforeVAT__c__f",TO_NUMBER(t.val110) "GEO_FixedFeeNext__c__f",TO_NUMBER(t.val117) "GEO_VATAmount__c__f",TO_NUMBER(t.val264) "GEO_GasVATAmount__c__f",t.val77 "GEO_Status__c__l",TO_NUMBER(t.val115) "GEO_SubtotalFeed__c__f",t.val190 "GEO_Email_Status__c__l",TO_NUMBER(t.val20) "UsrAlias59",TO_NUMBER(t.val108) "GEO_CounterRent__c__f",t.system_modstamp "SystemModstamp__f",TO_NUMBER(t.val97) "GEO_Total__c__f",TO_NUMBER(t.val71) "UsrAlias60",TO_NUMBER(t.val176) "UsrAlias61",TO_NUMBER(t.val152) "GEO_Toll_Energy_P2__c__f",TO_NUMBER(t.val260) "UsrAlias62",NULL "UsrAlias63",TO_NUMBER(t.val106) "UsrAlias64",TO_NUMBER(t.val114) "UsrAlias65",TO_NUMBER(t.val263) "GEO_GasTotal__c__f",TO_NUMBER(t.val86) "UsrAlias66",TO_NUMBER(t.val198) "UsrAlias67",TO_NUMBER(t.val84) "UsrAlias68",TO_NUMBER(t.val185) "UsrAlias69",TO_NUMBER(t.val63) "UsrAlias70",TO_NUMBER(t.val253) "GEO_DesvioMensual__c__f",TO_NUMBER(t.val313) "UsrAlias71",TO_NUMBER(t.val258) "UsrAlias72",TO_NUMBER(t.val257) "GEO_GasFeeBase__c__f",TO_DATE(t.val307) "UsrAlias73",TO_NUMBER(t.val262) "UsrAlias74",TO_NUMBER(t.val40) "GEO_Fixed_Fee__c__f",ROUND((NVL(TO_NUMBER(t.val199), 0)+NVL(NVL(TO_NUMBER(t.val262), 0), 0)), 2) "UsrAlias75",TO_NUMBER(t.val175) "UsrAlias76",TO_NUMBER(t.val113) "UsrAlias77",TO_NUMBER(t.val197) "UsrAlias78",TO_NUMBER(t.val269) "GEO_TotalGasFee__c__f",TO_NUMBER(t.val121) "UsrAlias79",TO_NUMBER(t.val109) "GEO_FixedFeeCurrent__c__f",TO_NUMBER(t.val66) "UsrAlias80",TO_NUMBER(t.val73) "UsrAlias81",ROUND(NVL(TO_NUMBER(t.val175), 0), 2) "UsrAlias82"from core.custom_entity_data t,core.custom_entity_data t_spn0,core.custom_entity_data t_spn1,sales.account t_spn1_0,sales.account t_spn1_1,core.record_type t_spn2,core.custom_entity_data t_spn3where (t.val0 = t_spn0.custom_entity_data_id(+))and (t.val180 = t_spn1.custom_entity_data_id(+))and (t_spn1.val0 = t_spn1_0.account_id(+))and (t_spn1.val1 = t_spn1_1.account_id(+))and (t.record_type_id = t_spn2.record_type_id(+))and (t.val255 = t_spn3.custom_entity_data_id(+))and (t.organization_id = 00D58000000IH3v)and (t.custom_entity_data_id != 000000000000000)and (t.key_prefix = :1 )and (t_spn0.organization_id(+) = 00D58000000IH3v)and (t_spn0.deleted(+) = 0)and (t_spn0.key_prefix(+) = :2 )and (t_spn1.organization_id(+) = 00D58000000IH3v)and (t_spn1.deleted(+) = 0)and (t_spn1.key_prefix(+) = :3 )and (t_spn1_0.organization_id(+) = 00D58000000IH3v)and (t_spn1_0.deleted(+) = 0)and (t_spn1_1.organization_id(+) = 00D58000000IH3v)and (t_spn1_1.deleted(+) = 0)and (t_spn2.organization_id(+) = 00D58000000IH3v)and (t_spn2.deleted(+) = 0)and (t_spn2.table_enum_or_id not in (Idea, Question, Reply)or t_spn2.table_enum_or_id is null)and (t_spn3.organization_id(+) = 00D58000000IH3v)and (t_spn3.deleted(+) = 0)and (t_spn3.key_prefix(+) = :4 ))where (("IsDeleted_gen_1" = 0)AND ("Id" = :5 )), OriginalSql = select /*SOQL*/ "LastModifiedDate","ColAlias1","LastModifiedById","GEO_PromoRecurrenteAplicada__c","ColAlias2","GEO_VerPDFReguladaGasSF__c","GEO_ReportadoHomeserve__c","ColAlias3","ColAlias4","GEO_CounterRent__c","CreatedById","ColAlias5","GEO_TollPower1__c","ColAlias6","ColAlias7","GEO_Invoiced_Consumption__c","ColAlias8","ColAlias9","ColAlias10","ColAlias11","GEO_TipoTelegestion__c","ColAlias12","PODO_Secondary_Payer__c","GEO_Correction_Invoice__c","ColAlias13","ColAlias14","ColAlias15","RecordTypeId","GEO_Adjusted_Consumption__c","GEO_VATAmountLuzGas__c","ColAlias16","GEO_Tariff__c","GEO_VerPDFReguladaLuzSF__c","GEO_Validacion_subtotal__c","SystemModstamp","GEO_Error_description__c","t.ID","GEO_Distributor_Phone__c","GEO_Distributor_Name__c","ColAlias17","ColAlias18","GEO_CorregidaOperaciones__c","Name","GEO_FixedFeeNext__c","ColAlias19","GEO_Toll_Energy_P1__c","GEO_PromocionGas__c","ColAlias20","GEO_Validacion_IVA__c","ColAlias21","CreatedDate","GEO_Address__c","GEO_PromoUnicaAplicada__c","GEO_Status__c","GEO_Invoice_URL__c","ColAlias22","GEO_TotalText__c","GEO_Correo_de_ajuste__c","GEO_Validacion_Cuota_del__c","ColAlias23","GEO_Invoice_Date__c","GEO_Invoice_Number__c","GEO_Email_Status__c","ColAlias24","ColAlias25","GEO_GasVATAmount__c","GEO_Fixed_Fee__c","GEO_Toll_Energy_P2__c","GEO_GasP1UnitPrice__c","GEO_Total__c","GEO_Previous_Reading_2__c","ColAlias26","GEO_Fecha_Factura_Monitorio__c","Invoice_Date_Month__c","ColAlias27","ColAlias28","ColAlias29","GEO_GCLEnviado__c","GEO_FacturaId__c","ColAlias30","GEO_First_Invoice__c","GEO_DesvioMensual__c","ColAlias31","PODO_Secondary_Payer_Quota__c","Id","GEO_IsDual__c","GEO_InvoiceDeCierre__c","ColAlias32","ColAlias33","ColAlias34","ColAlias35","ColAlias36","ColAlias37","ColAlias38","ColAlias39","GEO_PromoAplicada__c","ColAlias40","GEO_GasP1ConsumptionKwh__c","GEO_Smappe_discount__c","ColAlias41","GEO_PromoPodoAmigoAplicada__c","ColAlias42","GEO_TotalLuzGas__c","GEO_ContractNumber__c","GEO_GasFeeBase__c","GEO_estimatedEndOfContract__c","GEO_Invoice_Number_Inc__c","GEO_VerPdfInformes__c","ColAlias43","PODO_Invoice_Type__c","GEO_CUPS__c","GEO_GasTotal__c","GEO_Previous_Reading_1__c","GEO_CounterType__c","GEO_Current_Reading_1__c","GEO_VerPDFSF__c","GEO_TotalBeforeVAT__c","GEO_FixedFeeCurrent__c","GEO_NumeroDeAbono__c","GEO_Factura_Monitorio__c","ColAlias44","GEO_TotalGasFee__c","GEO_Current_Reading_2__c","ColAlias45","GEO_accumulated__c","ColAlias46","ColAlias47","GEO_SubtotalFeed__c","GEO_cme__c","GEO_Subtotal__c","GEO_MigradaAPv2__c","GEO_VATAmount__c","Ver_PDFSFMantenimiento__c","GEO_Sum_Consumptions__c","GEO_FacturaProforma__c","ColAlias48","GEO_Validacion_consumo__c","GEO_TollPower1__c__f","GEO_TotalLuzGas__c__f","UsrAlias49","CreatedDate__f","PODO_Invoice_Type__c__l","UsrAlias50","UsrAlias51","GEO_PromocionGas__c__f","UsrAlias52","GEO_Smappe_discount__c__f","GEO_Toll_Energy_P1__c__f","UsrAlias53","UsrAlias54","UsrAlias55","GEO_Invoice_Date__c__f","UsrAlias56","GEO_Subtotal__c__f","UsrAlias57","LastModifiedDate__f","UsrAlias58","GEO_VATAmountLuzGas__c__f","GEO_TotalBeforeVAT__c__f","GEO_FixedFeeNext__c__f","GEO_VATAmount__c__f","GEO_GasVATAmount__c__f","GEO_Status__c__l","GEO_SubtotalFeed__c__f","GEO_Email_Status__c__l","UsrAlias59","GEO_CounterRent__c__f","SystemModstamp__f","GEO_Total__c__f","UsrAlias60","UsrAlias61","GEO_Toll_Energy_P2__c__f","UsrAlias62","UsrAlias63","UsrAlias64","UsrAlias65","GEO_GasTotal__c__f","UsrAlias66","UsrAlias67","UsrAlias68","UsrAlias69","UsrAlias70","GEO_DesvioMensual__c__f","UsrAlias71","UsrAlias72","GEO_GasFeeBase__c__f","UsrAlias73","UsrAlias74","GEO_Fixed_Fee__c__f","UsrAlias75","UsrAlias76","UsrAlias77","UsrAlias78","GEO_TotalGasFee__c__f","UsrAlias79","GEO_FixedFeeCurrent__c__f","UsrAlias80","UsrAlias81","UsrAlias82"from (select /*+ ordered index(t pkcustom_entity_data) use_nl(t_spn0) use_nl(t_spn1) use_nl(t_spn1_0) use_nl(t_spn1_1) use_nl(t_spn2) use_nl(t_spn3) */t.deleted "IsDeleted_gen_1",t.custom_entity_data_id "Id",t.last_update "LastModifiedDate",t.val191 "ColAlias1",t.last_update_by "LastModifiedById",t.val240 "GEO_PromoRecurrenteAplicada__c",TO_NUMBER(t.val189) "ColAlias2",SUBSTR(CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN (https://mipodo--c.um4.visual.force.com/apex/GEO_PDF_FacturaReguladaGas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE END, 0, 1300) "GEO_VerPDFReguladaGasSF__c",t.val297 "GEO_ReportadoHomeserve__c",ROUND(NVL(TO_NUMBER(t.val302), 0), 2) "ColAlias3",TO_NUMBER(t.val92) "ColAlias4",TO_NUMBER(t.val108) "GEO_CounterRent__c",t.created_by "CreatedById",t.val255 "ColAlias5",TO_NUMBER(t.val170) "GEO_TollPower1__c",TO_NUMBER(t.val86) "ColAlias6",TO_NUMBER(t.val106) "ColAlias7",t.val0 "GEO_Invoiced_Consumption__c",t.val105 "ColAlias8",TO_NUMBER(t.val15) "ColAlias9",ROUND((NVL(TO_NUMBER(t.val97), 0)+NVL(TO_NUMBER(t.val157), 0)), 2) "ColAlias10",TO_NUMBER(t.val64) "ColAlias11",NULL "GEO_TipoTelegestion__c",t.val181 "ColAlias12",t.val180 "PODO_Secondary_Payer__c",t.val188 "GEO_Correction_Invoice__c",TO_NUMBER(t.val175) "ColAlias13",TO_NUMBER(t.val72) "ColAlias14",TO_NUMBER(t.val73) "ColAlias15",t.record_type_id "RecordTypeId",SUBSTR(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), 0, 1300) "GEO_Adjusted_Consumption__c",ROUND((NVL(TO_NUMBER(t.val264), 0)+NVL(TO_NUMBER(t.val117), 0)), 2) "GEO_VATAmountLuzGas__c",TO_NUMBER(t.val84) "ColAlias16",SUBSTR(t_spn0.val41, 0, 1300) "GEO_Tariff__c",SUBSTR((https://mipodo--c.um4.visual.force.com/apex/GEO_PDF_FacturaRegulada?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END), 0, 1300) "GEO_VerPDFReguladaLuzSF__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (NVL(TO_NUMBER(t.val116), 0)=((NVL(TO_NUMBER(t.val88), 0)+NVL(TO_NUMBER(t.val95), 0))+NVL(TO_NUMBER(t.val96), 0))) THEN 1 ELSE 0 END ELSE CASE WHEN (NVL(TO_NUMBER(t.val116), 0)=(NVL(TO_NUMBER(t.val114), 0)+NVL(TO_NUMBER(t.val115), 0))) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_subtotal__c",t.system_modstamp "SystemModstamp",t.val217 "GEO_Error_description__c",t.custom_entity_data_id "t.ID",NULL "GEO_Distributor_Phone__c",NULL "GEO_Distributor_Name__c",TO_NUMBER(t.val66) "ColAlias17",TO_NUMBER(t.val114) "ColAlias18",t.val286 "GEO_CorregidaOperaciones__c",t.name "Name",TO_NUMBER(t.val110) "GEO_FixedFeeNext__c",TO_NUMBER(t.val185) "ColAlias19",TO_NUMBER(t.val151) "GEO_Toll_Energy_P1__c",TO_NUMBER(t.val266) "GEO_PromocionGas__c",TO_NUMBER(t.val249) "ColAlias20",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))), 2)=NVL(TO_NUMBER(t.val117), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))), 2)=NVL(TO_NUMBER(t.val117), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_IVA__c",TO_NUMBER(t.val70) "ColAlias21",t.created_date "CreatedDate",NULL "GEO_Address__c",t.val241 "GEO_PromoUnicaAplicada__c",t.val77 "GEO_Status__c",SUBSTR(_HL_ENCODED_ || NVL((/servlet/servlet.FileDownload?file=||t.val182), ) || _HL_ || NVL(t.val183, ) || _HL_ || NVL(_blank, ) || _HL_, 0, 1300) "GEO_Invoice_URL__c",CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END "ColAlias22",SUBSTR(CASE WHEN (ROUND(TO_NUMBER(t.val189), 2) IS NULL) THEN REPLACE((TO_CHAR(ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2))), ., ,) ELSE REPLACE((TO_CHAR(ROUND(TO_NUMBER(t.val189), 2))), ., ,) END, 0, 1300) "GEO_TotalText__c",CASE WHEN NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR ((ABS(TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .)))>5) AND (NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$) OR NOT REGEXP_LIKE(REGEXP_REPLACE(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .),[0-9]+,0),^[+-]?(0|0\\.|\\.0|0\\.0)([Ee][+-]?0)?$))) THEN NULL ELSE CASE WHEN ((ABS(TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .)))>5) AND (TO_NUMBER(REPLACE(REPLACE((TO_CHAR((TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn0.val61), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn0.val62), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn0.val63), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))+TO_NUMBER(REPLACE(REPLACE((TO_CHAR(((ROUND(((NVL(TO_NUMBER(t_spn3.val61), 0) * NVL(TO_NUMBER(t_spn3.val31), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)+ROUND(((NVL(TO_NUMBER(t_spn3.val62), 0) * NVL(TO_NUMBER(t_spn3.val32), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2))+ROUND(((NVL(TO_NUMBER(t_spn3.val63), 0) * NVL(TO_NUMBER(t_spn3.val33), 0)) * NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0)), 2)))), ., ,), ,, .))))), ., ,), ,, .))>CASE WHEN (NVL(TO_NUMBER(t.val189), 0)=0) THEN (NVL(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 0)/10) ELSE (NVL(TO_NUMBER(t.val189), 0)/10) END) AND (NVL(t_spn2.name, Flexible||x)=Flexible)) THEN 1 ELSE 0 END END "GEO_Correo_de_ajuste__c",CASE WHEN (CASE WHEN ((CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) AND (EXTRACT (DAY FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END)=15) AND (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN ((NVL(t_spn0.val105, 0) = 1) OR ((EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))>15) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=2)) OR ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) AND ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=0)) THEN CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * NVL(TO_NUMBER(t.val210), 0)), 2)) AND (NVL(TO_NUMBER(t.val110), 0)=0)) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN (CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * (NVL(TO_NUMBER(t.val210), 0)-1)), 2)) AND (NVL(TO_NUMBER(t.val110), 0)=NVL(TO_NUMBER(t_spn0.val18), 0))) THEN 1 ELSE 0 END ELSE CASE WHEN ((NVL(TO_NUMBER(t.val109), 0)=0) AND (NVL(TO_NUMBER(t.val110), 0)=ROUND((NVL(TO_NUMBER(t_spn0.val18), 0) * NVL(TO_NUMBER(t.val210), 0)), 2))) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_Cuota_del__c",TO_NUMBER(t.val63) "ColAlias23",CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END "GEO_Invoice_Date__c",SUBSTR(LPAD((TO_CHAR(NVL(TO_NUMBER(t.val44), 0))), GREATEST(7, 0), 0), 0, 1300) "GEO_Invoice_Number__c",t.val190 "GEO_Email_Status__c",TO_NUMBER(t.val262) "ColAlias24",TO_NUMBER(t.val20) "ColAlias25",TO_NUMBER(t.val264) "GEO_GasVATAmount__c",TO_NUMBER(t.val40) "GEO_Fixed_Fee__c",TO_NUMBER(t.val152) "GEO_Toll_Energy_P2__c",TO_NUMBER(t.val261) "GEO_GasP1UnitPrice__c",TO_NUMBER(t.val97) "GEO_Total__c",TO_NUMBER(t.val54) "GEO_Previous_Reading_2__c",t.val312 "ColAlias26",TO_DATE(t.val307) "GEO_Fecha_Factura_Monitorio__c",ROUND(EXTRACT (MONTH FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END), 0) "Invoice_Date_Month__c",TO_NUMBER(t.val107) "ColAlias27",TO_NUMBER(t.val9) "ColAlias28",ROUND(NVL(TO_NUMBER(t.val175), 0), 2) "ColAlias29",t.val292 "GEO_GCLEnviado__c",t.val182 "GEO_FacturaId__c",CASE WHEN (NVL(TO_NUMBER(t.val108), 0)=ROUND((NVL(TO_NUMBER(t.val107), 0) * NVL(TO_NUMBER(t.val210), 0)), 2)) THEN 1 ELSE 0 END "ColAlias30",t.val37 "GEO_First_Invoice__c",TO_NUMBER(t.val253) "GEO_DesvioMensual__c",NULL "ColAlias31",ROUND(NVL((TO_NUMBER(t_spn1.val4) / 100.0), 0) * 100.0, 0) "PODO_Secondary_Payer_Quota__c",CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END "GEO_IsDual__c",CASE WHEN (NVL(CASE WHEN null THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END "GEO_InvoiceDeCierre__c",TO_NUMBER(t.val113) "ColAlias32",TO_NUMBER(t.val121) "ColAlias33",TO_NUMBER(t.val71) "ColAlias34",TO_NUMBER(t.val260) "ColAlias35",TO_NUMBER(t.val47) "ColAlias36",TO_NUMBER(t.val176) "ColAlias37",ROUND((NVL(TO_NUMBER(t.val199), 0)+NVL(NVL(TO_NUMBER(t.val262), 0), 0)), 2) "ColAlias38",TO_NUMBER(t.val313) "ColAlias39",CASE WHEN ((NVL(TO_NUMBER(t.val197), 0)>0) OR (NVL(TO_NUMBER(t.val186), 0)>0) OR (NVL(TO_NUMBER(t.val185), 0)>0) OR (NVL(TO_NUMBER(t.val198), 0)>0)) THEN 1 ELSE 0 END "GEO_PromoAplicada__c",TO_NUMBER(t.val197) "ColAlias40",TO_NUMBER(t.val259) "GEO_GasP1ConsumptionKwh__c",TO_NUMBER(t.val186) "GEO_Smappe_discount__c",NULL "ColAlias41",t.val239 "GEO_PromoPodoAmigoAplicada__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (ROUND((0.0511269632 * NVL(TO_NUMBER(t.val116), 0)), 2)=NVL(TO_NUMBER(t.val113), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ROUND((0.0511269632 * (NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val108), 0))), 2)=NVL(TO_NUMBER(t.val113), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "ColAlias42",ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2) "GEO_TotalLuzGas__c",NULL "GEO_ContractNumber__c",TO_NUMBER(t.val257) "GEO_GasFeeBase__c",TO_NUMBER(t.val195) "GEO_estimatedEndOfContract__c",TO_NUMBER(t.val44) "GEO_Invoice_Number_Inc__c",SUBSTR(CASE WHEN (NVL(t.val182, NULL||x)=NVL(NULL, t.val182||x)) THEN CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijogas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexigas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolargas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE NULL END ELSE CASE WHEN (t_spn0.val78 IS NOT NULL AND t_spn0.val78 = 4) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaabono?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijo?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexi?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolar?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexitres?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) END END END ELSE ((https://micuenta.mipodo.com/||PODO_InvoiceViewer?AttachmentURL=/servlet/servlet.FileDownload?file=)||t.val182) END, 0, 1300) "GEO_VerPdfInformes__c",TO_NUMBER(t.val258) "ColAlias43",t.val177 "PODO_Invoice_Type__c",SUBSTR(t_spn0.val4, 0, 1300) "GEO_CUPS__c",TO_NUMBER(t.val263) "GEO_GasTotal__c",TO_NUMBER(t.val53) "GEO_Previous_Reading_1__c",SUBSTR(CASE WHEN (NVL(null, 01||x)=01) THEN Telegestión operativa con Curva de Carga Horaria WHEN (NVL(null, 02||x)=02) THEN Telegestión Operativa sin curva de carga Horaria ELSE Sin Telegestión END, 0, 1300) "GEO_CounterType__c",TO_NUMBER(t.val24) "GEO_Current_Reading_1__c",SUBSTR(CASE WHEN (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END, NULL||x)<>NVL(NULL, CASE WHEN t.val0 = 000000000000000 THEN NULL ELSE t.val0 END||x)) AND (NVL(CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END, NULL||x)<>NVL(NULL, CASE WHEN t.val255 = 000000000000000 THEN NULL ELSE t.val255 END||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=1) THEN CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijogas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexigas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolargas?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE NULL END ELSE CASE WHEN (t_spn0.val78 IS NOT NULL AND t_spn0.val78 = 4) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaabono?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE CASE WHEN (NVL(t_spn2.developer_name, GEO_Fixed||x)=GEO_Fixed) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturafijo?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_Flexible||x)=GEO_Flexible) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexi?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) WHEN (NVL(t_spn2.developer_name, GEO_PlanaSolar||x)=GEO_PlanaSolar) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaplanasolar?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturaflexitres?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) END END END, 0, 1300) "GEO_VerPDFSF__c",ROUND(CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0)) END,TO_NUMBER(NULL)) ELSE NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0)) END,TO_NUMBER(NULL)) END, 2) "GEO_TotalBeforeVAT__c",TO_NUMBER(t.val109) "GEO_FixedFeeCurrent__c",SUBSTR(CASE WHEN (NVL(TO_NUMBER(t.val287), 0)<>0) THEN (A||LPAD((TO_CHAR(NVL(TO_NUMBER(t.val287), 0))), GREATEST(7, 0), 0)) ELSE t.val188 END, 0, 1300) "GEO_NumeroDeAbono__c",t.val306 "GEO_Factura_Monitorio__c",TO_NUMBER(t.val198) "ColAlias44",TO_NUMBER(t.val269) "GEO_TotalGasFee__c",TO_NUMBER(t.val25) "GEO_Current_Reading_2__c",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (((((((((((ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))), 2)+NVL(TO_NUMBER(t.val116), 0))-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val108), 0))-NVL(TO_NUMBER(t.val198), 0))-NVL(TO_NUMBER(t.val197), 0))=NVL(TO_NUMBER(t.val97), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (((((((((((ROUND((0.21 * (((((((NVL(TO_NUMBER(t.val116), 0)-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))), 2)+NVL(TO_NUMBER(t.val116), 0))-NVL(TO_NUMBER(t.val185), 0))-NVL(TO_NUMBER(t.val30), 0))-NVL(TO_NUMBER(t.val186), 0))+NVL(TO_NUMBER(t.val113), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val176), 0))-NVL(TO_NUMBER(t.val198), 0))-NVL(TO_NUMBER(t.val197), 0))=NVL(TO_NUMBER(t.val97), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "ColAlias45",TO_NUMBER(t.val194) "GEO_accumulated__c",TO_NUMBER(t.val8) "ColAlias46",t.val309 "ColAlias47",TO_NUMBER(t.val115) "GEO_SubtotalFeed__c",TO_NUMBER(t.val205) "GEO_cme__c",TO_NUMBER(t.val116) "GEO_Subtotal__c",t.val318 "GEO_MigradaAPv2__c",TO_NUMBER(t.val117) "GEO_VATAmount__c",SUBSTR(CASE WHEN (NVL(TO_NUMBER(t.val281), 0)<>0) THEN (https://mipodo--c.um4.visual.force.com/apex/geo_pdf_facturahomeserve?id=||CASE WHEN t.custom_entity_data_id = 000000000000000 THEN NULL ELSE t.custom_entity_data_id END) ELSE END, 0, 1300) "Ver_PDFSFMantenimiento__c",ROUND(NVL(TO_NUMBER(t_spn0.val8), 0), 2) "GEO_Sum_Consumptions__c",t.val308 "GEO_FacturaProforma__c",TO_NUMBER(t.val302) "ColAlias48",CASE WHEN (CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN CASE WHEN (((ROUND((NVL(TO_NUMBER(t_spn0.val5), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)), 2)+ROUND((NVL(TO_NUMBER(t_spn0.val6), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)), 2))+ROUND((NVL(TO_NUMBER(t_spn0.val7), 0) * NVL(TO_NUMBER(t_spn0.val33), 0)), 2))=NVL(TO_NUMBER(t.val88), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN ((NVL(t_spn2.name, Flexible||x)=Flexible) AND (CASE WHEN (NVL(t_spn0.val17, 0) = 1) THEN 1 ELSE 0 END=1) AND (EXTRACT (DAY FROM CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END)=15) AND (CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN ((NVL(t_spn0.val105, 0) = 1) OR ((EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))>15) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) OR (EXTRACT (DAY FROM TRUNC(t_spn0.created_date + (1/24.0)))=2)) OR ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) AND ((EXTRACT (MONTH FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN 12 ELSE NVL((EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) END) AND (EXTRACT (YEAR FROM TO_DATE(t_spn0.val39))=CASE WHEN (EXTRACT (MONTH FROM TRUNC(t_spn0.created_date + (1/24.0)))=1) THEN NVL((EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0)))-1),TO_NUMBER(NULL)) ELSE NVL(EXTRACT (YEAR FROM TRUNC(t_spn0.created_date + (1/24.0))),TO_NUMBER(NULL)) END))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END=0)) THEN CASE WHEN (NVL(TO_NUMBER(t.val114), 0)=0) THEN 1 ELSE 0 END ELSE CASE WHEN (CASE WHEN (NVL(t_spn2.name, Flexible||x)=Flexible) THEN CASE WHEN ((ROUND((NVL(TO_NUMBER(t_spn0.val5), 0) * NVL(TO_NUMBER(t_spn0.val31), 0)), 2)+ROUND((NVL(TO_NUMBER(t_spn0.val6), 0) * NVL(TO_NUMBER(t_spn0.val32), 0)), 2))=NVL(TO_NUMBER(t.val114), 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (0=NVL(TO_NUMBER(t.val114), 0)) THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END END) = 1 THEN 1 ELSE 0 END "GEO_Validacion_consumo__c",TO_NUMBER(t.val170) "GEO_TollPower1__c__f",ROUND(((NVL(TO_NUMBER(t.val263), 0)+NVL(TO_NUMBER(t.val97), 0))+NVL(TO_NUMBER(t.val281), 0)), 2) "GEO_TotalLuzGas__c__f",TO_NUMBER(t.val249) "UsrAlias49",t.created_date "CreatedDate__f",t.val177 "PODO_Invoice_Type__c__l",TO_NUMBER(t.val64) "UsrAlias50",TO_NUMBER(t.val107) "UsrAlias51",TO_NUMBER(t.val266) "GEO_PromocionGas__c__f",TO_NUMBER(t.val92) "UsrAlias52",TO_NUMBER(t.val186) "GEO_Smappe_discount__c__f",TO_NUMBER(t.val151) "GEO_Toll_Energy_P1__c__f",ROUND((NVL(TO_NUMBER(t.val97), 0)+NVL(TO_NUMBER(t.val157), 0)), 2) "UsrAlias53",TO_NUMBER(t.val302) "UsrAlias54",TO_NUMBER(t.val70) "UsrAlias55",CASE WHEN (NOT (TO_DATE(t_spn0.val109) IS NULL)) THEN NVL(TO_DATE(t_spn0.val109),TO_DATE(NULL)) ELSE NVL((TO_DATE(t_spn0.val15)+TRUNC(1)),TO_DATE(NULL)) END "GEO_Invoice_Date__c__f",TO_NUMBER(t.val72) "UsrAlias56",TO_NUMBER(t.val116) "GEO_Subtotal__c__f",TO_NUMBER(t.val189) "UsrAlias57",t.last_update "LastModifiedDate__f",TO_NUMBER(t.val47) "UsrAlias58",ROUND((NVL(TO_NUMBER(t.val264), 0)+NVL(TO_NUMBER(t.val117), 0)), 2) "GEO_VATAmountLuzGas__c__f",ROUND(CASE WHEN (NVL(t_spn2.name, PYME||x)=PYME) THEN NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(NVL(TO_NUMBER(t.val175), 0), 0))+NVL(TO_NUMBER(t.val108), 0)) END,TO_NUMBER(NULL)) ELSE NVL(CASE WHEN ((NVL(t.val181, 0) = 1) AND (NOT (NVL(CASE WHEN (NVL(CASE WHEN ((NVL(CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END, CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END||x)=NVL(CASE WHEN t_spn1_1.account_id = 000000000000000 THEN NULL ELSE t_spn1_1.account_id END, CASE WHEN t_spn1_0.account_id = 000000000000000 THEN NULL ELSE t_spn1_0.account_id END||x)) OR (NVL(t_spn1.name, t_spn1_0.name||x)=NVL(t_spn1_0.name, t_spn1.name||x))) THEN 1 ELSE 0 END, 0) = 1) THEN 1 ELSE 0 END, 0) = 1))) THEN ((((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0))+NVL(TO_NUMBER(t.val176), 0)) ELSE ((((NVL(TO_NUMBER(t.val116), 0)+NVL(TO_NUMBER(t.val113), 0))+NVL(TO_NUMBER(t.val106), 0))+NVL(TO_NUMBER(t.val313), 0))+NVL(TO_NUMBER(t.val175), 0)) END,TO_NUMBER(NULL)) END, 2) "GEO_TotalBeforeVAT__c__f",TO_NUMBER(t.val110) "GEO_FixedFeeNext__c__f",TO_NUMBER(t.val117) "GEO_VATAmount__c__f",TO_NUMBER(t.val264) "GEO_GasVATAmount__c__f",t.val77 "GEO_Status__c__l",TO_NUMBER(t.val115) "GEO_SubtotalFeed__c__f",t.val190 "GEO_Email_Status__c__l",TO_NUMBER(t.val20) "UsrAlias59",TO_NUMBER(t.val108) "GEO_CounterRent__c__f",t.system_modstamp "SystemModstamp__f",TO_NUMBER(t.val97) "GEO_Total__c__f",TO_NUMBER(t.val71) "UsrAlias60",TO_NUMBER(t.val176) "UsrAlias61",TO_NUMBER(t.val152) "GEO_Toll_Energy_P2__c__f",TO_NUMBER(t.val260) "UsrAlias62",NULL "UsrAlias63",TO_NUMBER(t.val106) "UsrAlias64",TO_NUMBER(t.val114) "UsrAlias65",TO_NUMBER(t.val263) "GEO_GasTotal__c__f",TO_NUMBER(t.val86) "UsrAlias66",TO_NUMBER(t.val198) "UsrAlias67",TO_NUMBER(t.val84) "UsrAlias68",TO_NUMBER(t.val185) "UsrAlias69",TO_NUMBER(t.val63) "UsrAlias70",TO_NUMBER(t.val253) "GEO_DesvioMensual__c__f",TO_NUMBER(t.val313) "UsrAlias71",TO_NUMBER(t.val258) "UsrAlias72",TO_NUMBER(t.val257) "GEO_GasFeeBase__c__f",TO_DATE(t.val307) "UsrAlias73",TO_NUMBER(t.val262) "UsrAlias74",TO_NUMBER(t.val40) "GEO_Fixed_Fee__c__f",ROUND((NVL(TO_NUMBER(t.val199), 0)+NVL(NVL(TO_NUMBER(t.val262), 0), 0)), 2) "UsrAlias75",TO_NUMBER(t.val175) "UsrAlias76",TO_NUMBER(t.val113) "UsrAlias77",TO_NUMBER(t.val197) "UsrAlias78",TO_NUMBER(t.val269) "GEO_TotalGasFee__c__f",TO_NUMBER(t.val121) "UsrAlias79",TO_NUMBER(t.val109) "GEO_FixedFeeCurrent__c__f",TO_NUMBER(t.val66) "UsrAlias80",TO_NUMBER(t.val73) "UsrAlias81",ROUND(NVL(TO_NUMBER(t.val175), 0), 2) "UsrAlias82"from core.custom_entity_data t,core.custom_entity_data t_spn0,core.custom_entity_data t_spn1,sales.account t_spn1_0,sales.account t_spn1_1,core.record_type t_spn2,core.custom_entity_data t_spn3where (t.val0 = t_spn0.custom_entity_data_id(+))and (t.val180 = t_spn1.custom_entity_data_id(+))and (t_spn1.val0 = t_spn1_0.account_id(+))and (t_spn1.val1 = t_spn1_1.account_id(+))and (t.record_type_id = t_spn2.record_type_id(+))and (t.val255 = t_spn3.custom_entity_data_id(+))and (t.organization_id = 00D58000000IH3v)and (t.custom_entity_data_id != 000000000000000)and (t.key_prefix = ?)and (t_spn0.organization_id(+) = 00D58000000IH3v)and (t_spn0.deleted(+) = 0)and (t_spn0.key_prefix(+) = ?)and (t_spn1.organization_id(+) = 00D58000000IH3v)and (t_spn1.deleted(+) = 0)and (t_spn1.key_prefix(+) = ?)and (t_spn1_0.organization_id(+) = 00D58000000IH3v)and (t_spn1_0.deleted(+) = 0)and (t_spn1_1.organization_id(+) = 00D58000000IH3v)and (t_spn1_1.deleted(+) = 0)and (t_spn2.organization_id(+) = 00D58000000IH3v)and (t_spn2.deleted(+) = 0)and (t_spn2.table_enum_or_id not in (Idea, Question, Reply)or t_spn2.table_enum_or_id is null)and (t_spn3.organization_id(+) = 00D58000000IH3v)and (t_spn3.deleted(+) = 0)and (t_spn3.key_prefix(+) = ?))where (("IsDeleted_gen_1" = 0)